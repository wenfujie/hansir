(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-abf73d42"],{"0653":function(t,e,s){"use strict";s("5548")},"1fa2":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page bg-gray flex-vbox"},[s("div",{staticClass:"flex-auto pd30 overflow-scroll"},[s("deliver-select",{ref:"deliverSelect",attrs:{showAreaList:t.showAreaList,areaList:t.areaList,showStoreList:t.showStoreList,storeList:t.storeList,Address:t.address,Store:t.store,params:t.shipParams},on:{"update:showAreaList":function(e){t.showAreaList=e},"update:areaList":function(e){t.areaList=e},"update:showStoreList":function(e){t.showStoreList=e},"update:storeList":function(e){t.storeList=e},"update:params":function(e){t.shipParams=e}}}),t.shopList&&1===t.shopList.length?s("div",{staticClass:"pay-one-good pd30"},[s("div",{staticClass:"pay-one-img"},[s("img",{attrs:{src:t.getImg(t.shopList[0].url),alt:""},on:{error:function(e){t.errImg(e)}}}),1==t.shopList[0].orderFlag||2==t.shopList[0].orderFlag?s("div",{staticClass:"pay-one-type"},[t._v("定制")]):t._e()]),s("div",{staticClass:"pay-one-info flex-vbox flex-auto"},[s("div",{staticClass:"flex-auto"},[s("div",{staticClass:"pay-one-name fs28 flex-auto"},[t._v(t._s(t.shopList[0].goodsName))]),s("div",{staticClass:"fs24 grey99 mgT10"},[t.shopList[0]&&t.shopList[0].mainFabricName?s("span",{staticClass:"pdLr5 pdTb2"},[t._v("定制颜色："+t._s(t.shopList[0].mainFabricName))]):t._e()])]),s("div",{staticClass:"pay-one-cont"},[s("div",{staticClass:"pay-one-btn flex-center",on:{click:function(e){t.viewCusList(t.shopList[0])}}},[s("span",[t._v(t._s(t.embList.length||t.eptList.length?"刺绣详情":"无刺绣信息"))]),t.embList.length||t.eptList.length?s("i",{staticClass:"iconfont icon-down"}):t._e()]),s("div",{staticClass:"pay-one-price"},[s("div",{staticClass:"pay-one-money fs26B"},[t._v("¥"+t._s(t._f("$goldDivide")(t.shopList[0].dealPrice)))]),s("div",{staticClass:"pay-one-num"},[t._v("X"+t._s(t.shopList[0].amount))])])])])]):s("goodImgView",{attrs:{goods:t.shopList},on:{viewGoods:function(e){t.toViewGoodList()}}}),s("action-cells",{ref:"actionCells",attrs:{actionList:t.Actionlist}}),s("div",{staticClass:"bg-white pd30"},[s("div",{staticClass:"flex-between mgB20"},[s("span",{staticClass:"fs28"},[t._v("商品金额")]),s("span",{staticClass:"fs28B"},[s("span",{staticClass:"fs24B"},[t._v("¥")]),t._v("\n                    "+t._s(t._f("$goldDivide")(t._f("Fix2")(t.totalPrice-t.custPrice)))+"\n                ")])]),t.custPrice?s("div",{staticClass:"flex-between mgB20"},[s("span",{staticClass:"fs28"},[t._v("刺绣金额")]),s("span",{staticClass:"fs28B"},[s("span",{staticClass:"fs24B"},[t._v("¥")]),t._v("\n                    "+t._s(t._f("$goldDivide")(t._f("Fix2")(t.custPrice)))+"\n                ")])]):t._e(),s("div",{staticClass:"flex-between mgB20"},[s("span",{staticClass:"fs28"},[t._v("会员折扣")]),s("span",{staticClass:"fs28B"},[s("span",{staticClass:"fs24B"},[t._v("-¥")]),t._v("\n                    "+t._s(t._f("$goldDivide")(t._f("Fix2")(t.price.vipPrice)))+"\n                ")])]),s("div",{staticClass:"flex-between mgB20"},[s("span",{staticClass:"fs28"},[t._v("促销优惠")]),s("span",{staticClass:"fs28B"},[s("span",{staticClass:"fs24B"},[t._v("-¥")]),t._v("\n                    "+t._s(t._f("$goldDivide")(t._f("Fix2")(t.promotions)))+"\n                ")])]),s("div",{staticClass:"flex-between"},[s("span",{staticClass:"fs28"},[t._v("运费")]),s("span",{staticClass:"fs28B"},[s("span",{staticClass:"fs24B"},[t._v("¥")]),t._v("\n                    "+t._s(t._f("$goldDivide")(t._f("Fix2")(t.transFee)))+"\n                ")])])])],1),s("div",{staticClass:"flex-box mgT10"},[s("div",{staticClass:"flex-auto bg-white flex-vcenter pdL30"},[s("span",{staticClass:"pay-foot-describe fs24"},[t._v("实付金额：")]),s("span",{staticClass:"pay-foot-money fs30B"},[s("span",{staticClass:"fs24B"},[t._v("¥")]),t._v("\n                "+t._s(t._f("$goldDivide")(t._f("Fix2")(t.actualPay)))+"\n            ")])]),s("div",{staticClass:"w40"},[s("button",{staticClass:"flex-button",on:{click:t.handleEmitBill}},[t._v("结算")])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showOnLoading,expression:"showOnLoading"}],staticClass:"shade-style"},[s("div",{staticClass:"loading-style"},[s("van-loading",{attrs:{type:"spinner",color:"white"}})],1)]),s("action-sheet",{ref:"cashCoupon",attrs:{title:"优惠券/体验卡",type:"cashCoupon","coupon-list":t.cashCouponList,"s-model":t.cardIds.cashCouponId},on:{onSelect:t.onSelectCashTicket},model:{value:t.showCashTickets,callback:function(e){t.showCashTickets=e},expression:"showCashTickets"}}),s("van-popup",{attrs:{position:"bottom"},model:{value:t.showAreaList,callback:function(e){t.showAreaList=e},expression:"showAreaList"}},[s("van-area",{attrs:{"area-list":t.areaList,"visible-item-count":5},on:{confirm:t.onAreaChange,cancel:function(e){t.showAreaList=!1}}})],1),s("van-popup",{attrs:{position:"bottom"},model:{value:t.showStoreList,callback:function(e){t.showStoreList=e},expression:"showStoreList"}},[s("van-picker",{attrs:{columns:t.storeList,"show-toolbar":""},on:{cancel:function(e){t.showStoreList=!1},confirm:t.onStoreSelected}})],1),s("goodSheet",{attrs:{goodsList:t.shopList},on:{viewCusList:t.viewCusList},model:{value:t.showGoodsList,callback:function(e){t.showGoodsList=e},expression:"showGoodsList"}}),s("customList",{attrs:{params:t.customList},model:{value:t.showCusList,callback:function(e){t.showCusList=e},expression:"showCusList"}}),s("van-popup",{model:{value:t.showPointDialogFlag,callback:function(e){t.showPointDialogFlag=e},expression:"showPointDialogFlag"}},[s("div",{staticClass:"point-dialog"},[s("p",{staticClass:"point-dialog-title pdTb30"},[t._v("积分规则")]),s("div",{staticClass:"point-dialog-cont pdLr30",attrs:{id:"pointDialog"},domProps:{innerHTML:t._s(t.userPointInfo.contentText)}}),s("div",{staticClass:"point-dialog-btn",on:{click:function(e){t.showPointDialogFlag=!1}}},[t._v("我知道了")])])])],1)},a=[],o=(s("f751"),s("456d"),s("e7e5"),s("d399")),n=(s("a481"),s("6b54"),s("ac6a"),s("96cf"),s("1da1")),r=(s("c5f6"),s("5548"),s("b650")),c=(s("5f5f"),s("f253")),d=(s("8a58"),s("e41f")),l=(s("db2c"),s("1125")),u=(s("ac1e"),s("543e")),h=(s("e17f"),s("2241")),p=s("22ce"),f=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-actionsheet",{staticClass:"w100 list-cont",attrs:{position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("div",{staticClass:"flex-vbox pdT30"},[s("div",{staticClass:"text-center fs36 pdB30"},[t._v("刺绣详情")]),s("div",{staticClass:"main-cont pdLr30"},[t.embInfo?s("ul",t._l(t.custList,function(e,i){return s("li",{key:e.id,staticClass:"flex-vbox mgB30 cust-item"},[s("div",{class:["flex-between","pdT20","pdB30","fs28","part-list"]},[s("div",[t._v(t._s(e.label))]),e.isImg?s("div",{staticClass:"flex-vbox"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.getImg(e.imgUrl),expression:"getImg(item.imgUrl)"}],staticClass:"cust-item-img",attrs:{alt:""}}),s("span",{staticClass:"cust-item-name"},[t._v(t._s(e.cont))])]):s("div",[t._v(t._s(e.cont))])])])})):t._e()])]),s("div",{staticClass:"flex-button",on:{click:function(e){t.onClose()}}},[t._v("关闭")])])},g=[],m=(s("3208"),s("c0b2")),v=s("bf3c"),C={components:{"van-actionsheet":m["a"],"van-popup":d["a"]},props:{params:Object,value:Boolean},data:function(){return{good:this.params,show:!1,DJTYPE:{10260501:!1,10260502:!0}}},computed:{embList:function(){var t=this.params.partList;return t&&t.length?t.filter(function(t){if(t.emb.length)return!0}):[]},eptList:function(){var t=this.params.partList;return t&&t.length?t.filter(function(t){if(t.ept.length)return!0}):[]},embInfo:function(){return this.embList.length?this.embList[0]:this.eptList.length?this.eptList[0]:null},custList:function(){var t=[],e=this.embInfo;return this.embList.length?t=[{id:1,label:"刺绣金额",cont:"￥"+e.emb[0].embprice},{id:2,label:"刺绣位置",cont:e.regionName},{id:3,label:"中英文刺绣",cont:e.emb[0].content},{id:4,label:"刺绣字体",cont:e.emb[0].fontsName},{id:5,label:"刺绣颜色",cont:e.emb[0].colorName}]:this.eptList.length&&(t=[{id:1,label:"刺绣金额",cont:"￥"+e.ept[0].embprice},{id:2,label:"刺绣位置",cont:e.regionName},{id:4,label:"刺绣颜色",cont:e.ept[0].colorName},{id:3,label:"星座刺绣",cont:e.ept[0].embName,imgUrl:e.ept[0].embFileUrl,isImg:!0}]),t}},methods:{onClose:function(){this.show=!1}},watch:{value:function(t){this.show=t},show:function(t){t||this.$emit("input",!1)}}},b=C,w=(s("9ae1"),s("2877")),I=Object(w["a"])(b,f,g,!1,null,"2617e21f",null);I.options.__file="customList.vue";var L=I.exports,y=s("4165"),x=s("4a98"),_=s("6604"),S=s("8396"),P=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bg-white mgB30 pd30"},[s("p",{staticClass:"fs28B mgB15"},[t._v("共 "+t._s(t.allAmount)+" 件商品")]),s("div",{staticClass:"flex-between",on:{click:function(e){t.viewGoodList()}}},[s("div",{staticClass:"flex-box"},t._l(t.goods,function(e,i){return i<3?s("div",{key:i,staticClass:"flex-auto mgR20",class:{cusTag:1==e.orderFlag}},[s("img",{staticClass:"image",attrs:{src:t.getImg(e.url)},on:{error:function(e){t.errImg(e)}}})]):t._e()})),t._m(0)])])},k=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex-vcenter"},[s("i",{staticClass:"iconfont icon-gengduo"})])}],F={props:{goods:Array},data:function(){return{}},computed:{allAmount:function(){var t=0;return this.goods.forEach(function(e){t+=e.amount}),t}},methods:{viewGoodList:function(){this.$emit("viewGoods",!0)}}},A=F,O=(s("63b7"),Object(w["a"])(A,P,k,!1,null,"99bc2f76",null));O.options.__file="goodImgView.vue";var M=O.exports,T=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("van-actionsheet",{model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("div",{staticClass:"header"},[s("div",{staticClass:"text-center flex-auto fs32B"},[t._v("商品清单")])]),t._l(t.goodsList,function(e,i){return s("goodSheetItem",{key:i,attrs:{good:e},on:{getCusList:t.getCusList}})}),s("button",{staticClass:"flex-button",on:{click:function(e){t.onClose()}}},[t._v("关闭")])],2)},N=[],U=(s("a44c"),s("e27c")),D=(s("4ddd"),s("9f14")),E=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex-box bg-white pd30"},[s("div",{staticClass:"w30"},[s("div",{staticClass:"goodPic",class:{cusTag:t.isCustom}},[s("img",{staticClass:"w100 h100",attrs:{src:t.getImg(t.good.url)},on:{error:function(e){t.errImg(e)}}})])]),s("div",{staticClass:"flex-auto flex-vbox flex-between"},[s("div",{staticClass:"fs28B"},[s("p",[t._v(t._s(t.good.goodsName))]),s("div",{staticClass:"fs24 grey99 mgT10"},[s("span",{directives:[{name:"show",rawName:"v-show",value:t.good.mainFabricName,expression:"good.mainFabricName"}],staticClass:"pdLr5 pdTb2"},[t._v("定制颜色："+t._s(t.good.mainFabricName))])])]),s("div",{staticClass:"mgT10"},[s("div",{staticClass:"fs24 grey99 mgB10"},[s("span",{staticClass:"bg-gray pdLr5 pdTb2",on:{click:function(e){e.stopPropagation(),t.showCusList()}}},[t._v("\n                    "+t._s(t.hasCustInfo?"刺绣详情":"无刺绣信息")+"\n                    "),t.hasCustInfo?s("i",{staticClass:"iconfont icon-down fs28"}):t._e()])]),s("div",{staticClass:"flex-between"},[s("div",{staticClass:"fs28B"},[s("span",{staticClass:"fs16B"},[t._v("¥")]),t._v("\n                    "+t._s(t.good.dealPrice)+"\n                ")]),s("div",{staticClass:"fs26"},[t._v("x"+t._s(t.good.amount))])])])])])},$=[],R={props:{good:Object},data:function(){return{}},methods:{showCusList:function(){this.$emit("getCusList",this.good)}},computed:{hasCustInfo:function(){for(var t=this.good.partList,e=0;e<t.length;e++)if(console.log(t[e].emb,t[e].ept),t[e].emb.length||t[e].ept.length)return!0;return!1},isCustom:function(){return 1==this.good.orderFlag},isGift:function(){return 1==this.good.isGift}}},B=R,j=(s("2482"),Object(w["a"])(B,E,$,!1,null,"92e3d630",null));j.options.__file="goodSheetItem.vue";var H=j.exports,W=s("c69b4"),G={props:{goodsList:Array,value:Boolean},data:function(){return{params:{name:"hh"},show:this.value}},methods:{onClose:function(){this.$emit("input",!1)},getCusList:function(t){this.$emit("viewCusList",t)}},components:{goodSheetItem:H,customList:W["a"],"van-actionsheet":m["a"],"van-popup":d["a"],"van-radio":D["a"],"van-radio-group":U["a"]},watch:{value:function(t){this.show=t},show:function(t){t||this.$emit("input",!1)},goodsList:function(t){}}},z=G,q=(s("f308"),Object(w["a"])(z,T,N,!1,null,"b58be9c4",null));q.options.__file="goodSheet.vue";var V=q.exports,J=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{staticClass:"flex-box h100px"},t._l(t.deliveryTypes,function(e){return s("div",{key:e.id,staticClass:"flex-auto flex-center",class:{active:t.method==e.shipCode,inActive:t.method!=e.shipCode},on:{click:function(s){t.onReiceveWayChanged(e)}}},[t._v(t._s(e.shipName))])})),s("div",{staticClass:"flex-vbox pd30"},["kdps"==t.method?s("div",{staticClass:"flex-box flex-auto w100 fs28",on:{click:function(e){t.onSelectAddr()}}},[t.addressMsg?s("div",{staticClass:"flex-between w100"},[s("div",{staticClass:"flex-vbox flex-auto"},[s("div",{staticClass:"flex-box pdTb10"},[s("div",{staticClass:"w25"},[t._v("联系人:")]),s("div",{staticClass:"flex-auto"},[t._v(t._s(t.kdpsUsrName))])]),s("div",{staticClass:"flex-box pdTb10"},[s("div",{staticClass:"w25"},[t._v("联系方式:")]),s("div",{staticClass:"flex-auto"},[t._v(t._s(t.kdpsPhone))])]),s("div",{staticClass:"flex-box pdTb10"},[s("div",{staticClass:"w25"},[t._v("联系地址:")]),s("div",{staticClass:"flex-auto"},[t._v(t._s(t.kdpsaddress))])])]),t._m(0)]):t._e(),t.addressMsg?t._e():s("div",{staticClass:"nAddress flex-center w100"},[s("div",{staticClass:"flex-vbox flex-center h100px",on:{click:function(e){t.onSelectAddr()}}},[s("i",{staticClass:"iconfont icon-daohang fs36"}),s("p",{staticClass:"mgT20 fs24 black-1A"},[t._v("请添加收货地址")])])])]):t._e(),"mdzq"==t.method?s("div",{staticClass:"flex-auto w100 fs28"},[s("div",{staticClass:"flex-box pdTb10 border1px"},[s("div",{staticClass:"w25 flex-vcenter"},[t._v("取货人")]),s("div",{staticClass:"flex-auto"},[s("van-field",{attrs:{clearable:"",placeholder:"请输入您的姓名",maxlength:"12"},on:{blur:function(e){t.onBlur("name")}},model:{value:t.storeForm.username,callback:function(e){t.$set(t.storeForm,"username",e)},expression:"storeForm.username"}})],1)]),s("div",{staticClass:"flex-box pdTb10 border1px"},[s("div",{staticClass:"w25 flex-vcenter"},[t._v("联系方式")]),s("div",{staticClass:"flex-auto"},[s("van-field",{attrs:{clearable:"",placeholder:"请输入您的联系方式",maxlength:"11"},on:{blur:function(e){t.onBlur("phone",t.storeForm.phone)}},model:{value:t.storeForm.phone,callback:function(e){t.$set(t.storeForm,"phone",e)},expression:"storeForm.phone"}})],1)]),s("div",{staticClass:"flex-box pdTb10 border1px",on:{click:function(e){t.onSelectEvent("area")}}},[s("div",{staticClass:"w25 flex-vcenter"},[t._v("取货地区")]),s("div",{staticClass:"flex-auto"},[s("van-field",{attrs:{clearable:"",placeholder:"请选择您的所在地区",readonly:!0},model:{value:t.storeForm.region,callback:function(e){t.$set(t.storeForm,"region",e)},expression:"storeForm.region"}})],1),t._m(1)]),s("div",{staticClass:"flex-box pdTb10",on:{click:function(e){t.onSelectEvent("store")}}},[s("div",{staticClass:"w25 flex-vcenter"},[t._v("取货门店")]),s("div",{staticClass:"flex-auto"},[s("van-field",{attrs:{clearable:"",placeholder:"请选择取货门店",readonly:!0},model:{value:t.storeForm.storeName,callback:function(e){t.$set(t.storeForm,"storeName",e)},expression:"storeForm.storeName"}})],1),t._m(2)])]):t._e()])])},Y=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex-center"},[s("i",{staticClass:"iconfont icon-gengduo"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex-center fs24"},[s("i",{staticClass:"iconfont icon-gengduo"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex-center fs24"},[s("i",{staticClass:"iconfont icon-gengduo"})])}],K=(s("7f7f"),s("0653"),s("34e9")),X=(s("be7f"),s("565f")),Z={props:{params:Object,Address:Array,Store:Object,areaList:Object,storeList:Array,showAreaList:Boolean,showStoreList:Boolean},components:{"van-field":X["a"],"van-cell-group":K["a"]},data:function(){return{storeForm:{username:"",phone:"",region:"",storeName:"",addressId:null,storeId:null},deliveryTypes:[],addressMsg:{},transFee:0,param:{kdps:{},mdzq:{}},shipWay:{shipCode:"",id:""},method:"kdps"}},methods:{onReiceveWayChanged:function(t){switch(this.method=t.shipCode,this.shipWay=t,t.shipCode){case"kdps":this.param.mdzq={},this.$parent.transFee=this.transFee,this.updateKdpsParams();break;case"mdzq":this.param.kdps={},this.getCityData(),this.updateMdzqParams(),this.$parent.transFee=0;break}},getShipType:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e,s,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={effFlag:1,policyTypeCode:"D_SALERETAIL"},t.next=3,p["h"].getShipType(e);case 3:s=t.sent,s.forEach(function(t){-1!=["kdps","mdzq"].indexOf(t.shipCode)&&i.deliveryTypes.push(t)}),this.deliveryTypes.reverse(),this.shipWay=this.deliveryTypes[0],console.log("shipWay",this.shipWay),this.updateKdpsParams();case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getAddress:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e,s,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=Storage.get("settlementAddr")||{},s=[],!v["a"].isEmpty(e)){t.next=9;break}return i={vipUsrId:Storage.get("USER_INFO").usrId},t.next=6,p["m"].getAddrList(i);case 6:s=t.sent,e=s.filter(function(t){return 1===t.defaultFlag})[0],Storage.set("settlementAddr",e);case 9:this.addressMsg=e||s[0],this.getTransFee(),this.updateKdpsParams();case 12:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getTransFee:function(){var t=this;if(this.addressMsg){var e={id:this.$parent.orderHdId,destCode:this.addressMsg.addressId?this.addressMsg.addressId:this.addressMsg.districtCode};this.addressMsg.destId&&(e.destId=this.addressMsg.destId),p["h"].getFreight(e).then(function(e){t.$parent.transFee=e,t.transFee=e})}},getCityData:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e,s,i,a,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(v["a"].isEmpty(this.areaList)){t.next=2;break}return t.abrupt("return");case 2:if(e=JSON.parse(sessionStorage.getItem("areaList")),!v["a"].isEmpty(e)){t.next=16;break}return e={},t.next=7,p["a"].getDestnation();case 7:s=t.sent,i={},a={},o={},s.list.forEach(function(t){t.destTypeId===s.code[0]&&(i[t.code]=t.name),t.destTypeId===s.code[1]&&(a[t.code]=t.name),t.destTypeId===s.code[2]&&(o[t.code]=t.name)}),e.province_list=i,e.city_list=a,e.county_list=o,sessionStorage.setItem("areaList",JSON.stringify(e));case 16:this.$emit("update:areaList",e);case 17:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getShopList:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var s,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return s={code:e,pageNo:1,pageSize:100},t.next=3,p["a"].getShopList(s);case 3:if(i=t.sent,console.log("store",i),!v["a"].isEmpty(i.list)){t.next=8;break}return Object(o["a"])("该地区暂无可取货的门店~"),t.abrupt("return");case 8:i.list.forEach(function(t){t.text=t.dptName,t.addressText=t.address}),this.$emit("update:storeList",i.list);case 10:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),onSelectAddr:function(){this.$router.push("/address-list?fromPage=settlement")},updateMdzqParams:function(){this.param.mdzq={cargoUsrName:this.storeForm.username,cargoMobile:this.storeForm.phone,buyUsrMobile:this.storeForm.phone,cargoAddr:this.storeForm.storeName,cargoDestrictCode:this.storeForm.addressId,recptDptId:this.storeForm.storeId,receiptWayCode:this.shipWay.shipCode,receiptWayId:this.shipWay.id},this.$emit("update:params",this.param)},updateKdpsParams:function(){if(!this.addressMsg)return this.param.kdps={cargoAddr:"",cargoUsrName:"",cargoMobile:"",buyUsrMobile:"",cargoDestrictCode:"",receiptWayCode:"",receiptWayId:""},void this.$emit("update:params",this.param);this.param.kdps={cargoAddr:this.addressMsg.address,cargoUsrName:this.addressMsg.cargousrName,cargoMobile:this.addressMsg.cargoMobile,buyUsrMobile:this.addressMsg.cargoMobile,cargoDestrictCode:this.addressMsg.districtCode?this.addressMsg.districtCode:this.addressMsg.addressId,receiptWayCode:this.shipWay.shipCode,receiptWayId:this.shipWay.id},this.$emit("update:params",this.param)},onBlur:function(t,e){if("phone"==t&&!isPhone(e)&&"mdzq"==this.method)return Object(o["a"])("请输入正确的联系方式!"),void(this.storeForm.phone="");this.updateMdzqParams()},onSelectEvent:function(t){switch(t){case"area":this.$emit("update:showAreaList",!0);break;case"store":if(v["a"].isEmpty(this.storeList))return void Object(o["a"])("该地区暂无可取货的门店~");this.$emit("update:showStoreList",!0);break}},onInit:function(){this.method="kdps",this.getShipType(),this.getAddress()}},computed:{kdpsUsrName:function(){if(this.addressMsg)return this.addressMsg.cargousrName},kdpsPhone:function(){if(this.addressMsg)return this.addressMsg.cargoPhone||this.addressMsg.cargoMobile},kdpsaddress:function(){if(this.addressMsg)return this.addressMsg.destDesc+this.addressMsg.address}},watch:{Address:function(t){this.storeForm.region="".concat(t[0].name,"-").concat(t[1].name,"-").concat(t[2].name),this.storeForm.addressId=t[2].code,this.updateMdzqParams(),this.getShopList(t[2].code)},Store:function(t){this.storeForm.storeName=t.dptName,this.storeForm.storeId=t.id,this.updateMdzqParams()}},created:function(){this.onInit()}},Q=Z,tt=(s("c2c6"),Object(w["a"])(Q,J,Y,!1,null,"289c9bb0",null));tt.options.__file="deliver-select.vue";var et=tt.exports,st={components:{customList:L,ActionCells:_["a"],ActionSheet:S["a"],goodImgView:M,goodSheet:V,deliverSelect:et,Dialog:h["a"],"van-loading":u["a"],"van-area":l["a"],"van-popup":d["a"],"van-picker":c["a"],"van-button":r["a"]},data:function(){return{price:{},vipDiscount:"",memo:"",showOnLoading:!1,Actionlist:{cashCoupon:{id:"1",name:"优惠券/体验卡",value:"无可用",action:this.onActionSheet,renderType:"arrow",type:"cashTicket"},searchInput:{id:"2",name:"",value:"",action:this.onSearchEvent,renderType:"input",blurAction:this.searchBlur,inputAction:this.searchInput,errMsg:""},integral:{id:"3",value:"",name:"积分",action:this.onSwitch,renderType:"swicth",unUseText:"",clickIcon:this.onClickPointerIcon,show:!0,showIcon:!0},balance:{id:"4",value:"-￥0",name:"账户余额",action:this.onSwitchBalance,renderType:"swicth",enable:!0},memo:{id:"5",name:"订单备注",value:"HAH",action:this.onRecieveMemo,renderType:"field"}},userPointInfo:{},transFee:0,balance:0,areaList:{},address:[],showAreaList:!1,storeList:[],store:{},shipParams:{kdps:{},mdzq:{}},showStoreList:!1,canUsePoint:!1,isPointUsed:!0,isBalanceUsed:!0,shopCart:{},shopList:[],customList:{},suitsList:[],singleList:[],disCouponList:[],cashCouponList:[],cardIds:{cashCouponId:null,searchCouponId:null,disCouponId:null},showGoodsList:!1,showCusList:!1,showDiscTickets:!1,showCashTickets:!1,showDalog:!0,showPointDialogFlag:!1}},watch:{transFee:function(){this.isBalanceUsed&&this.getUserGoldInfo()},"Actionlist.cashCoupon.value":function(t){-2==this.$refs.cashCoupon.$data.selectedModel?this.$refs.cashCoupon.$data.errMsg=t:this.$refs.cashCoupon.$data.errMsg=""}},methods:{onClickPointerIcon:function(){this.userPointInfo.contentText&&(this.showPointDialogFlag=!0)},onSwitch:function(t,e){this.isPointUsed=e,this.getDiscount()},onSwitchBalance:function(t,e){this.isBalanceUsed=e,e?this.getUserGoldInfo():this.Actionlist.balance.value=""},onActionSheet:function(t){switch(t.type){case"cashTicket":this.showCashTickets=!0;break;case"discTicket":this.showDiscTickets=!0;break;default:return!1}},onSearchEvent:function(t){var e=this;t&&(this.$refs.cashCoupon.$data.selectedModel=-1,p["o"].getCouponsId({cardCode:t,rtlOrdInterHdId:this.orderHdId}).then(function(t){t?(e.cardIds.searchCouponId=t,e.getDiscount(t,!1).then(function(t){var s=t.cashCouponPrice||t.storedValueCardPrice||t.disCouponPrice;(s||0===s)&&(e.Actionlist.searchInput.errMsg="优惠 ￥"+1*Number(s).toFixed(2)),e.isSearchCouponLoad=!1})):(e.cardIds.searchCouponId="",e.Actionlist.searchInput.errMsg="券号不存在",e.isSearchCouponLoad=!1)},function(t){880506241==t.errorCode?t.errorMsg="该券已被使用":880506236==t.errorCode&&(t.errorMsg="该券状态为【未领取】或【未投放】"),t.errorMsg&&(e.Actionlist.searchInput.errMsg=t.errorMsg),e.cardIds.searchCouponId="",e.isSearchCouponLoad=!1,e.getDiscount("",!1)}))},searchBlur:function(t){t?(this.isSearchCouponLoad=!0,this.onSearchEvent(t)):(this.cardIds.searchCouponId="",this.Actionlist.searchInput.errMsg="",this.getDiscount("",!1).then(function(t){}))},searchInput:function(t){this.searchInputValue=t},onRecieveMemo:function(t){this.memo=t},onAreaChange:function(t){this.showAreaList=!1,this.address=t,this.storeList=[],this.$refs.deliverSelect.$data.storeForm.storeName=""},onStoreSelected:function(t){this.showStoreList=!1,this.store=t},getUsableTickets:function(t){var e={ownCompanyId:this.Storage.get("COMPANYID").company_id,rtlOrdInterHdId:this.orderHdId,cardIds:t+""||""};return p["o"].getCanUseCouponsList(e)},onSelectCashTicket:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.cardIds.cashCouponId=e.cardId,e.cardId&&-1!=e.cardId){t.next=5;break}return this.Actionlist.cashCoupon.value=e.couponName,this.getDiscount(),t.abrupt("return");case 5:this.$refs.actionCells.inputEvent("clear"),this.Actionlist.searchInput.errMsg="",this.getDiscount();case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),toViewGoodList:function(t){this.showGoodsList=!0},viewCusList:function(t){console.log(t);for(var e=0;e<t.partList.length;e++){var s=t.partList[e];if(s.emb.length||s.ept.length){this.customList=t,this.showCusList=!0;break}}},combindShopList:function(t){var e=[];return!v["a"].isEmpty(t.combList)&&v["a"].isArray(t.combList)&&t.combList.forEach(function(t){e=e.concat(t.skuList)}),t.skuList.concat(e)},getShopList:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=JSON.parse(sessionStorage.getItem(this.orderHdId)),e){t.next=7;break}return s={ctmUsrId:this.Storage.get("USER_INFO").usrId,cookieId:this.Storage.get("USER_INFO").cookieId,rtlCartTempHdId:this.orderHdId||this.$route.query.orderHdId,busContsCode:baseConstant.busContsCode,shopCode:this.Storage.get("USER_INFO").shopCode},t.next=5,p["h"].getSettlementInfo(s);case 5:e=t.sent,sessionStorage.setItem(this.orderHdId,JSON.stringify(e));case 7:this.shopList=this.combindShopList(e);case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getVipDiscount:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={wxUnionid:baseConstant.signUpTypeCode,usrId:this.Storage.get("USER_INFO").usrId,companyId:this.Storage.get("COMPANYID").company_id},t.next=3,p["m"].getMyCardInfo(e);case 3:s=t.sent,this.vipDiscount=s.discount;case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getUsePointFlag:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,p["m"].getMinIntegral();case 2:s=t.sent,this.userPointInfo=s,1==this.userPointInfo.effFlag&&1==this.userPointInfo.integralFlag||(this.Actionlist.integral.show=!1),this.userPointInfo.contentText||(this.Actionlist.integral.showIcon=!1);case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getCouponsList:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e,s,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={shopId:this.Storage.get("USER_INFO").shopId,rtlOrdInterHdId:this.orderHdId,scopeId:0},t.next=3,p["o"].getOrderCouponsList(e);case 3:s=t.sent,this.disCouponList=[],this.cashCouponList=[],s.forEach(function(t){t.disabled=!1,null!==t.discount?i.disCouponList.push(t):i.cashCouponList.push(t)}),0==this.cashCouponList.length?this.Actionlist.cashCoupon.value="无可用":this.Actionlist.cashCoupon.value="不使用优惠券/体验卡";case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getDiscount:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var s,i,a,o,n=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return s=!(n.length>1&&void 0!==n[1])||n[1],e||(e=this.cardIdsFormat().toString()),i={companyId:this.Storage.get("COMPANYID").company_id,usrId:this.Storage.get("USER_INFO").usrId,rtlOrdInterHdId:this.orderHdId,cardIds:e||"",pointFlag:this.checkoutUsePoint?1:0},t.next=5,p["o"].getOrderDiscountPoint(i);case 5:return this.price=t.sent,this.checkoutUsePoint?this.Actionlist.integral.value="使用".concat(this.price.point,"积分抵扣")+(+this.price.pointPirce).toFixed(2)+"元":this.Actionlist.integral.value="",this.isBalanceUsed&&this.getUserGoldInfo(),s&&this.cardIds.cashCouponId>0&&(0!=this.price.cashCouponPrice&&(this.Actionlist.cashCoupon.value="-￥"+Number(Math.round(100*this.price.cashCouponPrice)/100)),0!=this.price.storedValueCardPrice&&(this.Actionlist.cashCoupon.value="-￥"+Number(Math.round(100*this.price.storedValueCardPrice)/100))),this.Actionlist.integral.show&&(a="",this.userPointInfo.moreThanMin?(o=this.price.salePrice+(this.price.pointPirce?this.price.pointPirce:0),o>=this.userPointInfo.integralValue*this.userPointInfo.ltnMinIntegral?(a="",this.checkoutUsePoint?this.Actionlist.integral.unUseText=a:(this.Actionlist.integral.unUseText=a,this.isPointUsed&&this.getDiscount())):(a="共".concat(this.userPointInfo.useablePoints,"积分，当前订单可用0积分"),this.checkoutUsePoint?(this.Actionlist.integral.unUseText=a,this.getDiscount()):this.Actionlist.integral.unUseText=a)):(a="共".concat(this.userPointInfo.useablePoints,"积分，满").concat(this.userPointInfo.ltnMinIntegral,"积分可用"),this.checkoutUsePoint?(this.Actionlist.integral.unUseText=a,this.getDiscount()):this.Actionlist.integral.unUseText=a)),t.abrupt("return",this.price);case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getUserGoldInfo:function(){var t=this,e=this.price.salePrice+this.transFee;p["d"].getFundDetail({}).then(function(s){t.balance=s?+s.userFund.toFixed(2):0;var i=0;e>0&&(i=e<=t.balance?e:t.balance),t.Actionlist.balance.value="-￥"+(+i).toFixed(2)})},onInit:function(){var t=this;this.orderHdId=this.$route.query.orderHdId,this.getShopList(),this.getVipDiscount(),this.getCouponsList(),this.getUsePointFlag().then(function(){t.getDiscount()});var e=document.documentElement.clientHeight||document.body.clientHeight;window.onresize=function(){var t=document.documentElement.clientHeight||document.body.clientHeight;e>t||window.scrollTo(0,5)}},toPay:function(t){var e=this;Object(y["a"])(this,t,this.actualPay).then(function(s){var i=[];e.shopList.forEach(function(t){i.push(t.goodsCode)});var a="/submitSuccess?billCode="+t+"&fromPage=payCode";if(s<=0)e.saving=!1,e.$router.replace(a),p["h"].packLevelUp({billCode:t}),p["h"].lockStock({billCode:t,operType:"FRONT_PAY"});else{var o="/waitPay?billCode="+t+"&ordStatusCode=D_ORDSPAYING";e.saving=!1,e.$router.go(-1),x["a"].miniProgramPay(s,a,o)}},function(s){e.saving=!1,Object(o["a"])("支付出错了~"),e.$router.replace("/waitPay?billCode="+t)})},cardIdsFormat:function(){for(var t=Object.keys(this.cardIds),e=[],s=0;s<t.length;s++){var i=this.cardIds[t[s]];if(i&&i>0){e[0]=i;break}}return e},getDeliverParams:function(){var t={buyUsrMobile:"电话不能为空",cargoUsrName:"姓名不能为空",cargoMobile:"电话不能为空",cargoAddr:"地址不能为空",cargoDestrictCode:"收货人地址编码不能为空",recptDptId:"店铺id不能为空",receiptWayCode:"取货方式不能为空",receiptWayId:"取货方式Id不能为空"},e={};for(var s in this.shipParams)v["a"].isEmpty(this.shipParams[s])||(e=this.shipParams[s]);var i=!0;for(var a in e)if(v["a"].isEmpty(e[a])){Object(o["a"])(t[a]),i=!1;break}return i?e:{}},handleEmitBill:function(){var t=this;if(!this.isSearchCouponLoad)if(!this.searchInputValue||this.cardIds.searchCouponId){var e=this.getDeliverParams();if(!v["a"].isEmpty(e)&&!this.saving){this.saving=!0,this.count++;var s={companyId:this.Storage.get("COMPANYID").company_id,usrId:this.Storage.get("USER_INFO").usrId,billId:this.orderHdId,balanceFlag:this.isBalanceUsed?1:0,busContsCode:baseConstant.busContsCode,shopCode:this.Storage.get("USER_INFO").shopCode,shopId:this.Storage.get("USER_INFO").shopId,sourceCode:"D_ORDWEIN",cartList:this.shopList,ctmUsrId:this.Storage.get("USER_INFO").usrId,ctmMessage:this.memo,promotionList:this.cardIdsFormat(),promotePartDto:[],pointFlag:this.checkoutUsePoint?1:0};console.log("billPay",Object.assign(s,e)),this.showOnLoading=!0,p["h"].saveOrder(Object.assign(s,e)).then(function(e){t.showOnLoading=!1,t.toPay(e),t.appointMeas(e)},function(e){t.saving=!1})}}else this.$refs.actionCells.inputEvent("focus")},appointMeas:function(t){var e=this.routeParams;"D_MSROPSIZE"==Storage.get("toReserveParams").measureOpCode?this.measure(t,e).then(function(t){},function(t){}):this.appointAndMeasure(t,e).then(function(t){},function(t){})},measure:function(t,e){if(e.liangti.billCode=t,e.liangti){var s={billCode:t,usrName:e.liangti.usrName,id:e.liangti.id,features:e.liangti.figureDtos||e.liangti.features||[]};return p["m"].updateChimaInfo(s)}},appointAndMeasure:function(t,e){var s=this,i={usrId:Storage.get("USER_INFO").usrId,ownCompanyId:Storage.get("COMPANYID").company_id,companyId:Storage.get("COMPANYID").company_id,ordHdCode:t,buscontsCode:baseConstant.busContsCode};return p["n"].getBillType(i).then(function(i){for(var a=[],o=0;o<i.length;o++)if("D_MSROPMSR"==i[o].measureOpCode){var n={saleOrdDtId:i[o].id};a.push(n)}return e.yuyue.rtlOrdHdCode=t,e.yuyue.saleOrdDtList=a,p["n"].saveVolume(e.yuyue).then(function(i){if(console.log("updateParams有数据",e),console.log("有id",i.id),e.liangti){if(i.id){var a={billCode:t,saleMeasureHdId:i.id,usrName:e.liangti.usrName,features:e.liangti.figureDtos||e.liangti.features||[],id:e.liangti.id};return p["m"].updateMemberBodyInfo(a)}return s.measure(t,e)}})})}},computed:{totalPrice:function(){var t=0;return this.shopList.forEach(function(e){t+=e.dealPrice*e.amount}),t},promotions:function(){var t=this,e=Object.keys(this.price),s=0,i=["cashCouponPrice","disCouponPrice","pointPirce","salePrice","storedValueCardPrice","vipPrice"];return e.length>0&&e.forEach(function(e){-1!==i.indexOf(e)&&(s+=t.price[e])}),this.totalPrice>0?this.totalPrice-s:s},actualPay:function(){var t=0;return 1==this.isBalanceUsed?(t=this.transFee+this.price.salePrice-this.balance,t=t<0?0:t):t=this.transFee+this.price.salePrice,+t.toFixed(2)},embList:function(){var t=this.shopList[0].partList;return t&&t.length?t.filter(function(t){if(t.emb.length)return!0}):[]},eptList:function(){var t=this.shopList[0].partList;return t&&t.length?t.filter(function(t){if(t.ept.length)return!0}):[]},custPrice:function(){return 1==this.shopList.length?this.embList.length?this.embList[0].emb[0].embprice*this.shopList[0].amount:this.eptList.length?this.eptList[0].ept[0].embprice*this.shopList[0].amount:0:0},checkoutUsePoint:function(){return this.Actionlist.integral.show&&!this.Actionlist.integral.unUseText&&this.isPointUsed}},created:function(){this.routeParams=this.$route.params,console.log(this.routeParams,"============"),console.log("原来在这",this.$route.params);var t=Object.keys(this.routeParams);t.length?Storage.set("reserveParams",this.routeParams):this.routeParams=Storage.get("reserveParams"),this.onInit()},beforeDestroy:function(){this.Storage.remove("settlementAddr")}},it=st,at=(s("2715"),Object(w["a"])(it,i,a,!1,null,"1c581337",null));at.options.__file="order-settle-yuyue.vue";e["default"]=at.exports},2482:function(t,e,s){"use strict";var i=s("3d8d"),a=s.n(i);a.a},2715:function(t,e,s){"use strict";var i=s("a013"),a=s.n(i);a.a},"308e":function(t,e,s){},"3ab3":function(t,e,s){},"3d8d":function(t,e,s){},4165:function(t,e,s){"use strict";s("e7e5");var i=s("d399"),a=(s("c5f6"),s("96cf"),s("1da1"));s("a481"),s("4917");function o(t,e){var s={timeStamp:t.timeStamp,nonceStr:t.nonceStr,package:t.prepayId,paySign:t.paySign},i=new Promise(function(t,i){t(0==e?0:s)});return i}e["a"]=function(){var t=Object(a["a"])(regeneratorRuntime.mark(function t(e,s,a,n,r){var c,d;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(a=Number(a),console.log(a,"_----"),0!==a){t.next=4;break}return t.abrupt("return",a);case 4:return c={usrId:e.Storage.get("USER_INFO").usrId,paymentCode:"D_WEIXIN",tradeTypeCode:"JSAPI",paymentTypeCode:r||"D_FULL",shopCode:e.Storage.get("USER_INFO").shopCode,orderList:s,orderType:n||null,openId:e.Storage.get("WECHAT_INFO").openid,payAmount:Number(a),unionId:Storage.get("properties").publicAccount},console.log(a,"===="),t.next=8,e.$post("payment/orderPayment",c);case 8:if(d=t.sent,"200"!==d.code){t.next=13;break}return t.abrupt("return",o(d,a));case 13:return Object(i["a"])(d.message),t.abrupt("return",Promise.reject());case 15:case"end":return t.stop()}},t,this)}));return function(e,s,i,a,o){return t.apply(this,arguments)}}()},"4a98":function(t,e,s){"use strict";var i=s("18a0"),a=s.n(i),o={miniProgramPay:function(t,e,s){var i={timeStamp:t.timeStamp,nonceStr:t.nonceStr,package:t.package,paySign:t.paySign,successUrl:e,failUrl:s||"/show"},o={config:i};a.a.miniProgram.navigateTo({url:"/page/pay/pay?payData="+encodeURIComponent(JSON.stringify(o))})},WebPay:function(t,e,s,i){a.a.config({debug:!1,appId:t.appId,timestamp:t.timestamp,nonceStr:t.nonceStr,signature:t.signature,jsApiList:["chooseWXPay"]}),a.a.chooseWXPay({timestamp:e.timestamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:e.paySign,success:function(t){if(-1===s.indexOf("http://")&&-1===s.indexOf("https://"))window.location.protocol,window.location.host,window.location.pathname;else window.location.href=s},error:function(t){if(-1===i.indexOf("http://")&&-1===i.indexOf("https://"))window.location.protocol,window.location.host,window.location.pathname;else window.location.href=i}})}};e["a"]=o},"63b7":function(t,e,s){"use strict";var i=s("d02c"),a=s.n(i);a.a},"9ae1":function(t,e,s){"use strict";var i=s("308e"),a=s.n(i);a.a},a013:function(t,e,s){},c2c6:function(t,e,s){"use strict";var i=s("db35"),a=s.n(i);a.a},d02c:function(t,e,s){},db35:function(t,e,s){},f308:function(t,e,s){"use strict";var i=s("3ab3"),a=s.n(i);a.a}}]);